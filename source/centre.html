@@include('header.htm')
@@include('blocks/navigation.htm')

 <script>
        document.addEventListener("DOMContentLoaded", function() {
    var params = new URLSearchParams(window.location.search);
    var name = params.get('nom').replace(/-/g, ' ');  // Remplacer les tirets par des espaces
    var postalCode = params.get('codePostal');
    var city = params.get('ville').replace(/-/g, ' ');  // Remplacer les tirets par des espaces

    

    var apiBaseUrl = window.location.hostname === 'localhost' ? 'http://localhost:3000' : 'https://www.ouieqare.com';

    fetch(`${apiBaseUrl}/api/centres/${encodeURIComponent(name)}/${postalCode}`)
        .then(response => {
            if (!response.ok) {
                console.error("Failed to fetch details:", response.statusText);
                throw new Error('Failed to fetch');
            }
            return response.json();
        })
        .then(data => {
            console.log("Data received:", data);
            var formattedName = name.replace(/([A-Z])/g, ' $1').trim();  // Ajoute des espaces avant les majuscules pour la lisibilité
            document.title = formattedName + " - Détails du Centre";
            var pageTitleElements = document.querySelectorAll('.page-title h2');
            pageTitleElements.forEach(function(element) {
                element.textContent = formattedName;
            });




            document.getElementById('name').textContent = data.Account_Name;
            //document.getElementById('phone').textContent = data.Phone;
            document.getElementById('address').textContent = data.Rue + ', ' + data.Code_postal + ' ' + data.Ville;
            document.getElementById('description').textContent = data.Description;

            var centreImage = document.getElementById('centreImage');
            if (data.URL_Image_Centre) {
                centreImage.src = data.URL_Image_Centre;
            } else {
                centreImage.src = 'https://example.com/default-logo.png';
            }
        })
        .catch(error => {
            console.error('Erreur lors du chargement des détails du centre:', error);
            document.getElementById('description').textContent = 'Description non disponible';
        });
});

    </script>
</head>
<body>
    @@include('header.htm')
    @@include('blocks/navigation.htm')
    @@include('blocks/page-title.htm', {"title": "Project Details", "description": "Single details"})

    <section class="section case-study">
        <div class="container">
            <div class="columns">
                <div class="column lg-6 column md-8">
                    <div class="case-content pl-4 mt-4 mt-lg-0">
                        <h3 class="mb-3" id="name"></h3>
                        <!-- <p id="phone"></p> -->
                        <h3>Présentation du centre</h3>
                        <p id="address"><i class="fas fa-map-marker-alt"></i></p>
                        <p><i class="fas fa-phone"></i> 09.85.40.72.28</p>
                        <p id="description"></p>
                    </div>
                    <div class="col-md-4 ">
                        <button class="btn btn-primary" onclick="window.open('https://tally.so/r/wvBMdQ', '_blank')">Prendre RDV</button>
                    </div>
                </div>
                <div class="column lg-6">
                    <div class="case-img">
                        <img alt="Centre Image" style="max-width: 300px; height: auto;" id="centreImage">
                    </div>
                </div>
            </div>
        </div>
    </section>
    @@include('blocks/footer.htm')
</body>
</html>