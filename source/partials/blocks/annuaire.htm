<section>
  <div class="search-container">
    <h1>Rechercher des Centres Audioprothésistes</h1>
    <form id="searchForm" class="search-form">
      <input
        type="text"
        id="searchInput"
        placeholder="Entrez le nom du centre, la ville ou le code postal"
        class="input-field"
      />
      <button type="submit" class="submit-button">Rechercher</button>
    </form>
    <div id="results" class="results"></div>
  </div>
  <script>
    document
      .getElementById("searchForm")
      .addEventListener("submit", function (event) {
        event.preventDefault();
        const searchQuery = document.getElementById("searchInput").value;

        // Construire l'URL de l'API basée sur la saisie de l'utilisateur
        let url = new URL('http://localhost:3000/api/centres'),
            params = {query: searchQuery}
        Object.keys(params).forEach(key => url.searchParams.append(key, params[key]))

        fetch(url)
          .then((response) => {
            if (!response.ok) {
              throw new Error('Network response was not OK');
            }
            return response.json();
          })
          .then((data) => {
            const resultsContainer = document.getElementById("results");
            resultsContainer.innerHTML = ""; // Clear previous results
            if (data.length > 0) {
              data.forEach((item) => {
                const div = document.createElement("div");
                div.textContent = `${item.Account_Name}, ${item.address}, ${item.Ville}, ${item.Code_postal}`;
                resultsContainer.appendChild(div);
              });
            } else {
              resultsContainer.innerHTML = '<p>Aucun résultat trouvé.</p>';
            }
          })
          .catch((error) => {
            console.error("Error:", error);
            document.getElementById('results').innerHTML = '<p>Erreur lors de la recherche.</p>';
          });
      });
  </script>
</section>
